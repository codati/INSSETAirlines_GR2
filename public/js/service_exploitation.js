$(document).ready(function()
{
    $("form#ChoixLigne").change(function() {
        $("#load-label").html('<img src="/img/loading_squares.gif" alt="Loading" />');
        
        id = $("form#ChoixLigne option:selected").val();
        reservationPlace = $("#reservationPlace").val();
        $.get('/serviceexploitation/gestionlstvol', {Ligne:id, reservationPlace:reservationPlace}, function(data)
        {
            $("#load-label").html('');
            $("#lst_vol").html(data);
            prepare();
        });
        
    });
    
    $("#lst_vol tr.ligne").live('click', function()Â {
    	id = $(this).attr('id');
        reservationPlace = $("#reservationPlace");
        console.log(reservationPlace.length);
        if(reservationPlace.length == 0)
        {
            display = $("#lst_vol tr#rem_"+id).css('display');

            if(display == 'none') {$("#lst_vol tr#rem_"+id).css('display', 'table-row');}
            else {$("#lst_vol tr#rem_"+id).css('display', 'none');}
        }
    });
    
    $("#lst_vol tr.remarque img#valid").live('click', function()
    {
    	id = $(this).parents('tr').attr('id');
    	mod = $("#mod_"+id).val();
    	val = $("#val_"+id).val();
    	
    	$.post('/serviceexploitation/editremarque', {id:id, val:val}, function(data)
    	{
    		$("#lst_vol tr#"+id+" span").html(val);
    		$("#mod_"+id).val('0');
    	});
    });
    
    $("#lst_vol tr.remarque img#cancel").live('click', function()
    {
    	id = $(this).parents('tr').attr('id');
    	ori = $("#mod_"+id).val();
    	
    	$(this).parents('span').html(ori);
    	$("#mod_"+id).val('-1');
    });
    
    $("#lst_vol tr.remarque").live('click', function()
    {
    	id = $(this).attr('id');
    	mod = $("#mod_"+id).val();
    	
    	if(mod == '0')
    	{
	    	val = $(this).children("td").children("span").html();
    		mod = $("#mod_"+id).val(val);
	    	
	    	html  = '<input type="text" value="'+val+'" id="val_'+id+'" />';
	    	html += '&nbsp;&nbsp;<img src="/img/tick.png" alt="Valider" id="valid" />';
	    	html += '&nbsp;&nbsp;<img src="/img/cross.png" alt="Annuler" id="cancel" />';
	    	
	    	$(this).children("td").children("span").html(html);
	    }
	    
	    if(mod == '-1') {$("#mod_"+id).val('0');}
    });
});